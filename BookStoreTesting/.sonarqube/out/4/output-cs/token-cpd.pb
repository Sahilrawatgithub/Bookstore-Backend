ül
,D:\BridgeLabz\BookStore\BookStore\Program.cs
	namespace 	
	BookStore
 
{ 
public 

class 
Program 
{ 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{ 	
var 
logger 
= 
NLogBuilder $
.$ %
ConfigureNLog% 2
(2 3
$str3 @
)@ A
.A B!
GetCurrentClassLoggerB W
(W X
)X Y
;Y Z
try 
{ 
var 
builder 
= 
WebApplication ,
., -
CreateBuilder- :
(: ;
args; ?
)? @
;@ A
logger 
. 
Info 
( 
$str 5
)5 6
;6 7
builder!! 
.!! 
Services!!  
.!!  !
AddDbContext!!! -
<!!- .
UserContext!!. 9
>!!9 :
(!!: ;
options!!; B
=>!!C E
options"" 
."" 
UseSqlServer"" (
(""( )
builder"") 0
.""0 1
Configuration""1 >
.""> ?
GetConnectionString""? R
(""R S
$str""S d
)""d e
)""e f
)""f g
;""g h
var$$ 
redisConfig$$ 
=$$  !
builder$$" )
.$$) *
Configuration$$* 7
.$$7 8

GetSection$$8 B
($$B C
$str$$C [
)$$[ \
.$$\ ]
Value$$] b
;$$b c
builder&& 
.&& 
Logging&& 
.&&  
ClearProviders&&  .
(&&. /
)&&/ 0
;&&0 1
builder'' 
.'' 
Logging'' 
.''  
SetMinimumLevel''  /
(''/ 0
LogLevel''0 8
.''8 9
Information''9 D
)''D E
;''E F
builder(( 
.(( 
Host(( 
.(( 
UseNLog(( $
((($ %
)((% &
;((& '
builder++ 
.++ 
Services++  
.++  !
AddSingleton++! -
<++- ."
IConnectionMultiplexer++. D
>++D E
(++E F!
ConnectionMultiplexer++F [
.++[ \
Connect++\ c
(++c d
redisConfig++d o
)++o p
)++p q
;++q r
builder,, 
.,, 
Services,,  
.,,  !
	AddScoped,,! *
(,,* +
provider,,+ 3
=>,,4 6
{-- 
var.. 

connection.. "
=..# $
provider..% -
...- .
GetRequiredService... @
<..@ A"
IConnectionMultiplexer..A W
>..W X
(..X Y
)..Y Z
;..Z [
return// 

connection// %
.//% &
GetDatabase//& 1
(//1 2
)//2 3
;//3 4
}00 
)00 
;00 
builder33 
.33 
Services33  
.33  !
	AddScoped33! *
<33* +
IUserRL33+ 2
,332 3

UserImplRl334 >
>33> ?
(33? @
)33@ A
;33A B
builder44 
.44 
Services44  
.44  !
	AddScoped44! *
<44* +
IUserBL44+ 2
,442 3

UserImplBL444 >
>44> ?
(44? @
)44@ A
;44A B
builder66 
.66 
Services66  
.66  !
	AddScoped66! *
<66* +
PasswordHasher66+ 9
>669 :
(66: ;
)66; <
;66< =
builder77 
.77 
Services77  
.77  !
	AddScoped77! *
<77* +
AuthService77+ 6
>776 7
(777 8
)778 9
;779 :
builder99 
.99 
Services99  
.99  !
	AddScoped99! *
<99* +
IBookRL99+ 2
,992 3

BookImplRL994 >
>99> ?
(99? @
)99@ A
;99A B
builder:: 
.:: 
Services::  
.::  !
	AddScoped::! *
<::* +
IBookBL::+ 2
,::2 3

BookImplBL::4 >
>::> ?
(::? @
)::@ A
;::A B
builder<< 
.<< 
Services<<  
.<<  !
	AddScoped<<! *
<<<* +

IAddressRL<<+ 5
,<<5 6
AddressImplRL<<7 D
><<D E
(<<E F
)<<F G
;<<G H
builder== 
.== 
Services==  
.==  !
	AddScoped==! *
<==* +

IAddressBL==+ 5
,==5 6
AddressImplBL==6 C
>==C D
(==D E
)==E F
;==F G
builder?? 
.?? 
Services??  
.??  !
	AddScoped??! *
<??* +
IOrderRL??+ 3
,??3 4
OrderImplRL??5 @
>??@ A
(??A B
)??B C
;??C D
builder@@ 
.@@ 
Services@@  
.@@  !
	AddScoped@@! *
<@@* +
IOrderBL@@+ 3
,@@3 4
OrderImplBL@@5 @
>@@@ A
(@@A B
)@@B C
;@@C D
builderBB 
.BB 
ServicesBB  
.BB  !
	AddScopedBB! *
<BB* +
IWishlistRLBB+ 6
,BB6 7
WishlistImplRLBB8 F
>BBF G
(BBG H
)BBH I
;BBI J
builderCC 
.CC 
ServicesCC  
.CC  !
	AddScopedCC! *
<CC* +
IWishlistBLCC+ 6
,CC6 7
WishlistImplBLCC8 F
>CCF G
(CCG H
)CCH I
;CCI J
builderEE 
.EE 
ServicesEE  
.EE  !
	AddScopedEE! *
<EE* +
ICartRLEE+ 2
,EE2 3

CartImplRLEE4 >
>EE> ?
(EE? @
)EE@ A
;EEA B
builderFF 
.FF 
ServicesFF  
.FF  !
	AddScopedFF! *
<FF* +
ICartBLFF+ 2
,FF2 3

CartImplBLFF4 >
>FF> ?
(FF? @
)FF@ A
;FFA B
builderGG 
.GG 
ServicesGG  
.GG  !
	AddScopedGG! *
<GG* +
	PublisherGG+ 4
>GG4 5
(GG5 6
)GG6 7
;GG7 8
builderJJ 
.JJ 
ServicesJJ  
.JJ  !
AddHostedServiceJJ! 1
<JJ1 2#
RabbitMqConsumerServiceJJ2 I
>JJI J
(JJJ K
)JJK L
;JJL M
varLL 
jwtKeyLL 
=LL 
builderLL $
.LL$ %
ConfigurationLL% 2
[LL2 3
$strLL3 <
]LL< =
;LL= >
varMM 
	jwtIssuerMM 
=MM 
builderMM  '
.MM' (
ConfigurationMM( 5
[MM5 6
$strMM6 B
]MMB C
;MMC D
varNN 
jwtAudienceNN 
=NN  !
builderNN" )
.NN) *
ConfigurationNN* 7
[NN7 8
$strNN8 F
]NNF G
;NNG H
builderPP 
.PP 
ServicesPP  
.PP  !
AddAuthenticationPP! 2
(PP2 3
optionsPP3 :
=>PP; =
{QQ 
optionsRR 
.RR %
DefaultAuthenticateSchemeRR 5
=RR6 7
JwtBearerDefaultsRR8 I
.RRI J 
AuthenticationSchemeRRJ ^
;RR^ _
optionsSS 
.SS "
DefaultChallengeSchemeSS 2
=SS3 4
JwtBearerDefaultsSS5 F
.SSF G 
AuthenticationSchemeSSG [
;SS[ \
}TT 
)TT 
.UU 
AddJwtBearerUU 
(UU 
optionsUU %
=>UU& (
{VV 
optionsWW 
.WW %
TokenValidationParametersWW 5
=WW6 7
newWW8 ;%
TokenValidationParametersWW< U
{XX 
ValidateIssuerYY &
=YY' (
trueYY) -
,YY- .
ValidateAudienceZZ (
=ZZ) *
trueZZ+ /
,ZZ/ 0
ValidateLifetime[[ (
=[[) *
true[[+ /
,[[/ 0$
ValidateIssuerSigningKey\\ 0
=\\1 2
true\\3 7
,\\7 8
ValidIssuer]] #
=]]$ %
	jwtIssuer]]& /
,]]/ 0
ValidAudience^^ %
=^^& '
jwtAudience^^( 3
,^^3 4
IssuerSigningKey__ (
=__) *
new__+ . 
SymmetricSecurityKey__/ C
(__C D
Encoding__D L
.__L M
UTF8__M Q
.__Q R
GetBytes__R Z
(__Z [
jwtKey__[ a
)__a b
)__b c
}`` 
;`` 
}aa 
)aa 
;aa 
builderdd 
.dd 
Servicesdd  
.dd  !
AddControllersdd! /
(dd/ 0
)dd0 1
;dd1 2
builderff 
.ff 
Servicesff  
.ff  !#
AddEndpointsApiExplorerff! 8
(ff8 9
)ff9 :
;ff: ;
buildergg 
.gg 
Servicesgg  
.gg  !
AddSwaggerGengg! .
(gg. /
cgg/ 0
=>gg1 3
{hh 
cii 
.ii 

SwaggerDocii  
(ii  !
$strii! %
,ii% &
newii' *
OpenApiInfoii+ 6
{ii7 8
Titleii9 >
=ii? @
$striiA L
,iiL M
VersioniiN U
=iiV W
$striiX \
}ii] ^
)ii^ _
;ii_ `
ckk 
.kk !
AddSecurityDefinitionkk +
(kk+ ,
$strkk, 4
,kk4 5
newkk6 9!
OpenApiSecuritySchemekk: O
{ll 
Inmm 
=mm 
ParameterLocationmm .
.mm. /
Headermm/ 5
,mm5 6
Descriptionnn #
=nn$ %
$strnn& B
,nnB C
Nameoo 
=oo 
$stroo .
,oo. /
Typepp 
=pp 
SecuritySchemeTypepp 1
.pp1 2
Httppp2 6
,pp6 7
Schemeqq 
=qq  
$strqq! )
}rr 
)rr 
;rr 
ctt 
.tt "
AddSecurityRequirementtt ,
(tt, -
newtt- 0&
OpenApiSecurityRequirementtt1 K
{uu  
{vv 
newww "!
OpenApiSecuritySchemeww# 8
{xx  
	Referenceyy# ,
=yy- .
newyy/ 2
OpenApiReferenceyy3 C
{zz# $
Type{{' +
={{, -
ReferenceType{{. ;
.{{; <
SecurityScheme{{< J
,{{J K
Id||' )
=||* +
JwtBearerDefaults||, =
.||= > 
AuthenticationScheme||> R
}}}# $
}~~  
,~~  !
Array $
.$ %
Empty% *
<* +
string+ 1
>1 2
(2 3
)3 4
}
ÄÄ 
}
ÅÅ  
)
ÅÅ  !
;
ÅÅ! "
}
ÇÇ 
)
ÇÇ 
;
ÇÇ 
builder
ÑÑ 
.
ÑÑ 
Services
ÑÑ  
.
ÑÑ  !
AddCors
ÑÑ! (
(
ÑÑ( )
options
ÑÑ) 0
=>
ÑÑ1 3
{
ÖÖ 
options
ÜÜ 
.
ÜÜ 
	AddPolicy
ÜÜ %
(
ÜÜ% &
$str
ÜÜ& 0
,
ÜÜ0 1
policy
áá 
=>
áá !
{
àà 
policy
ââ" (
.
ââ( )
AllowAnyOrigin
ââ) 7
(
ââ7 8
)
ââ8 9
.
ää" #
AllowAnyHeader
ää# 1
(
ää1 2
)
ää2 3
.
ãã" #
AllowAnyMethod
ãã# 1
(
ãã1 2
)
ãã2 3
;
ãã3 4
}
åå 
)
åå 
;
åå 
}
çç 
)
çç 
;
çç 
var
èè 
app
èè 
=
èè 
builder
èè !
.
èè! "
Build
èè" '
(
èè' (
)
èè( )
;
èè) *
if
íí 
(
íí 
app
íí 
.
íí 
Environment
íí #
.
íí# $
IsDevelopment
íí$ 1
(
íí1 2
)
íí2 3
)
íí3 4
{
ìì 
app
îî 
.
îî 

UseSwagger
îî "
(
îî" #
)
îî# $
;
îî$ %
app
ïï 
.
ïï 
UseSwaggerUI
ïï $
(
ïï$ %
)
ïï% &
;
ïï& '
}
ññ 
app
òò 
.
òò !
UseHttpsRedirection
òò '
(
òò' (
)
òò( )
;
òò) *
app
öö 
.
öö 
UseCors
öö 
(
öö 
$str
öö &
)
öö& '
;
öö' (
app
õõ 
.
õõ 
UseAuthentication
õõ %
(
õõ% &
)
õõ& '
;
õõ' (
app
úú 
.
úú 
UseAuthorization
úú $
(
úú$ %
)
úú% &
;
úú& '
app
üü 
.
üü 
MapControllers
üü "
(
üü" #
)
üü# $
;
üü$ %
app
°° 
.
°° 
Run
°° 
(
°° 
)
°° 
;
°° 
}
¢¢ 
catch
££ 
(
££ 
	Exception
££ 
ex
££ 
)
££  
{
§§ 
logger
•• 
.
•• 
Error
•• 
(
•• 
ex
•• 
,
••  
$str
••! K
)
••K L
;
••L M
}
¶¶ 
finally
ßß 
{
®® 
NLog
©© 
.
©© 

LogManager
©© 
.
©©  
Shutdown
©©  (
(
©©( )
)
©©) *
;
©©* +
}
™™ 
}
´´ 	
}
¨¨ 
}≠≠ Ä@
CD:\BridgeLabz\BookStore\BookStore\Controllers\WishListController.cs
	namespace 	
	BookStore
 
. 
Controllers 
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public		 

class		 
WishListController		 #
:		$ %
ControllerBase		& 4
{

 
private 
readonly 
IWishlistBL $
_wishlistBL% 0
;0 1
public 
WishListController !
(! "
IWishlistBL" -

wishlistBL. 8
)8 9
{ 	
_wishlistBL 
= 

wishlistBL $
;$ %
} 	
[ 	
HttpPost	 
( 
$str  
)  !
]! "
public 
async 
Task 
< 
IActionResult '
>' (
WishlistBook) 5
(5 6
int6 9
bookId: @
)@ A
{ 	
try 
{ 
var 
userId 
= 
Convert $
.$ %
ToInt32% ,
(, -
User- 1
.1 2
Claims2 8
.8 9
FirstOrDefault9 G
(G H
xH I
=>J L
xM N
.N O
TypeO S
==T V
$strW [
)[ \
?\ ]
.] ^
Value^ c
)c d
;d e
var 
result 
= 
await "
_wishlistBL# .
.. /
WishlistBookAsync/ @
(@ A
bookIdA G
,G H
userIdI O
)O P
;P Q
if 
( 
result 
. 
Success "
==# %
true& *
)* +
{ 
return 
Ok 
( 
result $
)$ %
;% &
} 
else 
{ 
return 

BadRequest %
(% &
result& ,
), -
;- .
} 
} 
catch   
(   
	Exception   
ex   
)    
{!! 
return"" 

StatusCode"" !
(""! "
$num""" %
,""% &
new""' *
{""+ ,
message""- 4
=""5 6
ex""7 9
.""9 :
Message"": A
}""B C
)""C D
;""D E
}## 
}$$ 	
[%% 	
HttpGet%%	 
(%% 
$str%% (
)%%( )
]%%) *
public&& 
async&& 
Task&& 
<&& 
IActionResult&& '
>&&' (!
GetAllWishlistedBooks&&) >
(&&> ?
)&&? @
{'' 	
try(( 
{)) 
var** 
userId** 
=** 
Convert** $
.**$ %
ToInt32**% ,
(**, -
User**- 1
.**1 2
Claims**2 8
.**8 9
FirstOrDefault**9 G
(**G H
x**H I
=>**J L
x**M N
.**N O
Type**O S
==**T V
$str**W [
)**[ \
?**\ ]
.**] ^
Value**^ c
)**c d
;**d e
var++ 
result++ 
=++ 
await++ "
_wishlistBL++# .
.++. /&
GetAllWishlistedBooksAsync++/ I
(++I J
userId++J P
)++P Q
;++Q R
if,, 
(,, 
result,, 
.,, 
Success,, "
==,,# %
true,,& *
),,* +
{-- 
return.. 
Ok.. 
(.. 
result.. $
)..$ %
;..% &
}// 
else00 
{11 
return22 

BadRequest22 %
(22% &
result22& ,
)22, -
;22- .
}33 
}44 
catch55 
(55 
	Exception55 
ex55 
)55  
{66 
return77 

StatusCode77 !
(77! "
$num77" %
,77% &
new77' *
{77+ ,
message77- 4
=775 6
ex777 9
.779 :
Message77: A
}77B C
)77C D
;77D E
}88 
}99 	
[:: 	

HttpDelete::	 
(:: 
$str:: ,
)::, -
]::- .
public;; 
async;; 
Task;; 
<;; 
IActionResult;; '
>;;' ("
RemoveBookFromWishlist;;) ?
(;;? @
int;;@ C
bookId;;D J
);;J K
{<< 	
try== 
{>> 
var?? 
userId?? 
=?? 
Convert?? $
.??$ %
ToInt32??% ,
(??, -
User??- 1
.??1 2
Claims??2 8
.??8 9
FirstOrDefault??9 G
(??G H
x??H I
=>??J L
x??M N
.??N O
Type??O S
==??T V
$str??W [
)??[ \
???\ ]
.??] ^
Value??^ c
)??c d
;??d e
var@@ 
result@@ 
=@@ 
await@@ "
_wishlistBL@@# .
.@@. /'
RemoveBookFromWishlistAsync@@/ J
(@@J K
bookId@@K Q
,@@Q R
userId@@S Y
)@@Y Z
;@@Z [
ifAA 
(AA 
resultAA 
.AA 
SuccessAA "
==AA# %
trueAA& *
)AA* +
{BB 
returnCC 
OkCC 
(CC 
resultCC $
)CC$ %
;CC% &
}DD 
elseEE 
{FF 
returnGG 

BadRequestGG %
(GG% &
resultGG& ,
)GG, -
;GG- .
}HH 
}II 
catchJJ 
(JJ 
	ExceptionJJ 
exJJ 
)JJ  
{KK 
returnLL 

StatusCodeLL !
(LL! "
$numLL" %
,LL% &
newLL' *
{LL+ ,
messageLL- 4
=LL5 6
exLL7 9
.LL9 :
MessageLL: A
}LLB C
)LLC D
;LLD E
}MM 
}NN 	
[OO 	

HttpDeleteOO	 
(OO 
$strOO #
)OO# $
]OO$ %
publicPP 
asyncPP 
TaskPP 
<PP 
IActionResultPP '
>PP' (
ClearWishlistPP) 6
(PP6 7
)PP7 8
{QQ 	
tryRR 
{SS 
varTT 
userIdTT 
=TT 
ConvertTT $
.TT$ %
ToInt32TT% ,
(TT, -
UserTT- 1
.TT1 2
ClaimsTT2 8
.TT8 9
FirstOrDefaultTT9 G
(TTG H
xTTH I
=>TTJ L
xTTM N
.TTN O
TypeTTO S
==TTT V
$strTTW [
)TT[ \
?TT\ ]
.TT] ^
ValueTT^ c
)TTc d
;TTd e
varUU 
resultUU 
=UU 
awaitUU "
_wishlistBLUU# .
.UU. /
ClearWishlistAsyncUU/ A
(UUA B
userIdUUB H
)UUH I
;UUI J
ifVV 
(VV 
resultVV 
.VV 
SuccessVV "
==VV# %
trueVV& *
)VV* +
{WW 
returnXX 
OkXX 
(XX 
resultXX $
)XX$ %
;XX% &
}YY 
elseZZ 
{[[ 
return\\ 

BadRequest\\ %
(\\% &
result\\& ,
)\\, -
;\\- .
}]] 
}^^ 
catch__ 
(__ 
	Exception__ 
ex__ 
)__  
{`` 
returnaa 

StatusCodeaa !
(aa! "
$numaa" %
,aa% &
newaa' *
{aa+ ,
messageaa- 4
=aa5 6
exaa7 9
.aa9 :
Messageaa: A
}aaB C
)aaC D
;aaD E
}bb 
}cc 	
}dd 
}ee œR
?D:\BridgeLabz\BookStore\BookStore\Controllers\UserController.cs
	namespace 	
	BookStore
 
. 
Controllers 
{		 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
UserController 
:  !
ControllerBase" 0
{ 
private 
readonly 
IUserBL  
userBL! '
;' (
public 
UserController 
( 
IUserBL %
userBL& ,
), -
{ 	
this 
. 
userBL 
= 
userBL  
;  !
} 	
[ 	
HttpPost	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (
RegisterUserAsync) :
(: ;
[; <
FromBody< D
]D E

RegUserDTOF P
requestQ X
)X Y
{ 	
try 
{ 
var 
result 
= 
await "
userBL# )
.) *
RegisterUserAsync* ;
(; <
request< C
)C D
;D E
if 
( 
result 
. 
Success "
)" #
{ 
return 
Ok 
( 
result $
)$ %
;% &
} 
return 

BadRequest !
(! "
result" (
)( )
;) *
}   
catch!! 
(!! 
	Exception!! 
ex!! 
)!!  
{"" 
return## 

StatusCode## !
(##! "
$num##" %
,##% &
new##' *
ResponseDTO##+ 6
<##6 7
string##7 =
>##= >
{$$ 
Success%% 
=%% 
false%% #
,%%# $
Message&& 
=&& 
ex&&  
.&&  !
Message&&! (
,&&( )
Data'' 
='' 
null'' 
}(( 
)(( 
;(( 
})) 
}** 	
[,, 	
HttpPost,,	 
(,, 
$str,, 
),, 
],, 
public-- 
async-- 
Task-- 
<-- 
IActionResult-- '
>--' (

LoginAsync--) 3
(--3 4
string--4 :
email--; @
,--@ A
string--B H
password--I Q
)--Q R
{.. 	
try// 
{00 
var11 
result11 
=11 
await11 "
userBL11# )
.11) *

LoginAsync11* 4
(114 5
email115 :
,11: ;
password11< D
)11D E
;11E F
if22 
(22 
result22 
.22 
Success22 "
)22" #
{33 
return44 
Ok44 
(44 
result44 $
)44$ %
;44% &
}55 
return66 

BadRequest66 !
(66! "
result66" (
)66( )
;66) *
}77 
catch88 
(88 
	Exception88 
ex88 
)88  
{99 
return:: 

StatusCode:: !
(::! "
$num::" %
,::% &
new::' *
ResponseDTO::+ 6
<::6 7
LoginResponseDTO::7 G
>::G H
{;; 
Success<< 
=<< 
false<< #
,<<# $
Message== 
=== 
ex==  
.==  !
Message==! (
,==( )
Data>> 
=>> 
null>> 
}?? 
)?? 
;?? 
}@@ 
}AA 	
[BB 	
	AuthorizeBB	 
]BB 
[CC 	
HttpGetCC	 
(CC 
$strCC 
)CC 
]CC  
publicDD 
asyncDD 
TaskDD 
<DD 
IActionResultDD '
>DD' (
GetAllUsersAsyncDD) 9
(DD9 :
)DD: ;
{EE 	
tryFF 
{GG 
varHH 
resultHH 
=HH 
awaitHH "
userBLHH# )
.HH) *
GetAllUsersAsyncHH* :
(HH: ;
)HH; <
;HH< =
ifII 
(II 
resultII 
.II 
SuccessII "
)II" #
{JJ 
returnKK 
OkKK 
(KK 
resultKK $
)KK$ %
;KK% &
}LL 
returnMM 

BadRequestMM !
(MM! "
resultMM" (
)MM( )
;MM) *
}NN 
catchOO 
(OO 
	ExceptionOO 
exOO 
)OO  
{PP 
returnQQ 

StatusCodeQQ !
(QQ! "
$numQQ" %
,QQ% &
newQQ' *
ResponseDTOQQ+ 6
<QQ6 7
ListQQ7 ;
<QQ; <

UserEntityQQ< F
>QQF G
>QQG H
{RR 
SuccessSS 
=SS 
falseSS #
,SS# $
MessageTT 
=TT 
exTT  
.TT  !
MessageTT! (
,TT( )
DataUU 
=UU 
nullUU 
}VV 
)VV 
;VV 
}WW 
}XX 	
[ZZ 	
	AuthorizeZZ	 
]ZZ 
[[[ 	

HttpDelete[[	 
([[ 
$str[[  
)[[  !
][[! "
public\\ 
async\\ 
Task\\ 
<\\ 
IActionResult\\ '
>\\' (
DeleteUserAsync\\) 8
(\\8 9
string\\9 ?
email\\@ E
)\\E F
{]] 	
try^^ 
{__ 
var`` 
result`` 
=`` 
await`` "
userBL``# )
.``) *
DeleteUserAsync``* 9
(``9 :
email``: ?
)``? @
;``@ A
ifaa 
(aa 
resultaa 
.aa 
Successaa "
)aa" #
{bb 
returncc 
Okcc 
(cc 
resultcc $
)cc$ %
;cc% &
}dd 
returnee 

BadRequestee !
(ee! "
resultee" (
)ee( )
;ee) *
}ff 
catchgg 
(gg 
	Exceptiongg 
exgg 
)gg  
{hh 
returnii 

StatusCodeii !
(ii! "
$numii" %
,ii% &
newii' *
ResponseDTOii+ 6
<ii6 7
stringii7 =
>ii= >
{jj 
Successkk 
=kk 
falsekk #
,kk# $
Messagell 
=ll 
exll  
.ll  !
Messagell! (
,ll( )
Datamm 
=mm 
nullmm 
}nn 
)nn 
;nn 
}oo 
}pp 	
[qq 	
HttpPostqq	 
(qq 
$strqq "
)qq" #
]qq# $
publicrr 
asyncrr 
Taskrr 
<rr 
IActionResultrr '
>rr' (
ForgotPasswordAsyncrr) <
(rr< =
stringrr= C
emailrrD I
)rrI J
{ss 	
trytt 
{uu 
varvv 
resultvv 
=vv 
awaitvv "
userBLvv# )
.vv) *
ForgotPasswordAsyncvv* =
(vv= >
emailvv> C
)vvC D
;vvD E
ifww 
(ww 
resultww 
.ww 
Successww "
)ww" #
{xx 
returnyy 
Okyy 
(yy 
resultyy $
)yy$ %
;yy% &
}zz 
return{{ 

BadRequest{{ !
({{! "
result{{" (
){{( )
;{{) *
}|| 
catch}} 
(}} 
	Exception}} 
ex}} 
)}}  
{~~ 
return 

StatusCode !
(! "
$num" %
,% &
new' *
ResponseDTO+ 6
<6 7
string7 =
>= >
{
ÄÄ 
Success
ÅÅ 
=
ÅÅ 
false
ÅÅ #
,
ÅÅ# $
Message
ÇÇ 
=
ÇÇ 
ex
ÇÇ  
.
ÇÇ  !
Message
ÇÇ! (
,
ÇÇ( )
Data
ÉÉ 
=
ÉÉ 
null
ÉÉ 
}
ÑÑ 
)
ÑÑ 
;
ÑÑ 
}
ÖÖ 
}
ÜÜ 	
[
áá 	
	Authorize
áá	 
]
áá 
[
àà 	
HttpPut
àà	 
(
àà 
$str
àà  
)
àà  !
]
àà! "
public
ââ 
async
ââ 
Task
ââ 
<
ââ 
IActionResult
ââ '
>
ââ' ( 
ResetPasswordAsync
ââ) ;
(
ââ; <
string
ââ< B
email
ââC H
,
ââH I
string
ââJ P
newPassword
ââQ \
)
ââ\ ]
{
ää 	
try
ãã 
{
åå 
var
çç 
result
çç 
=
çç 
await
çç "
userBL
çç# )
.
çç) * 
ResetPasswordAsync
çç* <
(
çç< =
email
çç= B
,
ççB C
newPassword
ççD O
)
ççO P
;
ççP Q
if
éé 
(
éé 
result
éé 
.
éé 
Success
éé "
)
éé" #
{
èè 
return
êê 
Ok
êê 
(
êê 
result
êê $
)
êê$ %
;
êê% &
}
ëë 
return
íí 

BadRequest
íí !
(
íí! "
result
íí" (
)
íí( )
;
íí) *
}
ìì 
catch
îî 
(
îî 
	Exception
îî 
ex
îî 
)
îî  
{
ïï 
return
ññ 

StatusCode
ññ !
(
ññ! "
$num
ññ" %
,
ññ% &
new
ññ' *
ResponseDTO
ññ+ 6
<
ññ6 7
string
ññ7 =
>
ññ= >
{
óó 
Success
òò 
=
òò 
false
òò #
,
òò# $
Message
ôô 
=
ôô 
ex
ôô  
.
ôô  !
Message
ôô! (
,
ôô( )
Data
öö 
=
öö 
null
öö 
}
õõ 
)
õõ 
;
õõ 
}
úú 
}
ùù 	
}
ûû 
}üü ‚"
@D:\BridgeLabz\BookStore\BookStore\Controllers\OrderController.cs
	namespace 	
	BookStore
 
. 
Controllers 
{ 
[ 
Route 

(
 
$str 
) 
] 
[		 
ApiController		 
]		 
public

 

class

 
OrderController

  
:

! "
ControllerBase

# 1
{ 
private 
readonly 
IOrderBL !
_orderBL" *
;* +
public 
OrderController 
( 
IOrderBL '
orderBL( /
)/ 0
{ 	
_orderBL 
= 
orderBL 
; 
} 	
[ 	
HttpPost	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (
	OrderBook) 2
(2 3
OrderDTO3 ;
order< A
)A B
{ 	
try 
{ 
var 
userId 
= 
Convert $
.$ %
ToInt32% ,
(, -
User- 1
.1 2
Claims2 8
.8 9
FirstOrDefault9 G
(G H
xH I
=>J L
xM N
.N O
TypeO S
==T V
$strW [
)[ \
?\ ]
.] ^
Value^ c
)c d
;d e
var 
result 
= 
await "
_orderBL# +
.+ ,
OrderBookAsync, :
(: ;
order; @
,@ A
userIdB H
)H I
;I J
if 
( 
result 
. 
Success "
==# %
true& *
)* +
{ 
return 
Ok 
( 
result $
)$ %
;% &
} 
else 
{ 
return 

BadRequest %
(% &
result& ,
), -
;- .
}   
}!! 
catch"" 
("" 
	Exception"" 
ex"" 
)""  
{## 
return$$ 

StatusCode$$ !
($$! "
$num$$" %
,$$% &
new$$' *
{$$+ ,
message$$- 4
=$$5 6
ex$$7 9
.$$9 :
Message$$: A
}$$B C
)$$C D
;$$D E
}%% 
}&& 	
['' 	
HttpGet''	 
('' 
$str'' 
)''  
]''  !
public(( 
async(( 
Task(( 
<(( 
IActionResult(( '
>((' (
GetAllOrders(() 5
(((5 6
)((6 7
{)) 	
try** 
{++ 
var,, 
userId,, 
=,, 
Convert,, $
.,,$ %
ToInt32,,% ,
(,,, -
User,,- 1
.,,1 2
Claims,,2 8
.,,8 9
FirstOrDefault,,9 G
(,,G H
x,,H I
=>,,J L
x,,M N
.,,N O
Type,,O S
==,,T V
$str,,W [
),,[ \
?,,\ ]
.,,] ^
Value,,^ c
),,c d
;,,d e
var-- 
result-- 
=-- 
await-- "
_orderBL--# +
.--+ ,
GetAllOrdersAsync--, =
(--= >
userId--> D
)--D E
;--E F
if.. 
(.. 
result.. 
... 
Success.. "
==..# %
true..& *
)..* +
{// 
return00 
Ok00 
(00 
result00 $
)00$ %
;00% &
}11 
else22 
{33 
return44 

BadRequest44 %
(44% &
result44& ,
)44, -
;44- .
}55 
}66 
catch77 
(77 
	Exception77 
ex77 
)77  
{88 
return99 

StatusCode99 !
(99! "
$num99" %
,99% &
new99' *
{99+ ,
message99- 4
=995 6
ex997 9
.999 :
Message99: A
}99B C
)99C D
;99D E
}:: 
};; 	
}<< 
}== Â*
?D:\BridgeLabz\BookStore\BookStore\Controllers\BookController.cs
	namespace 	
	BookStore
 
. 
Controllers 
{ 
[		 
Route		 

(		
 
$str		 
)		 
]		 
[

 
ApiController

 
]

 
public 

class 
BookController 
:  !
ControllerBase" 0
{ 
private 
readonly 
IBookBL  
_bookBL! (
;( )
public 
BookController 
( 
IBookBL %
bookBL& ,
), -
{ 	
_bookBL 
= 
bookBL 
; 
} 	
[ 	
	Authorize	 
] 
[ 	
HttpPost	 
( 
$str 
) 
]  
public 
async 
Task 
< 
IActionResult '
>' (

UploadBook) 3
(3 4
AddBookReqDTO4 A
requestB I
)I J
{ 	
try 
{ 
var 
userId 
= 
Convert $
.$ %
ToInt32% ,
(, -
User- 1
.1 2
Claims2 8
.8 9
FirstOrDefault9 G
(G H
xH I
=>J L
xM N
.N O
TypeO S
==T V
$strW [
)[ \
?\ ]
.] ^
Value^ c
)c d
;d e
var 
result 
= 
await "
_bookBL# *
.* +
UploadBookAsync+ :
(: ;
request; B
,B C
userIdC I
)I J
;J K
if 
( 
result 
. 
Success "
==# %
true& *
)* +
{ 
return 
Ok 
( 
result $
)$ %
;% &
} 
else 
{   
return!! 

BadRequest!! %
(!!% &
result!!& ,
)!!, -
;!!- .
}"" 
}## 
catch$$ 
($$ 
	Exception$$ 
ex$$ 
)$$  
{%% 
return&& 

StatusCode&& !
(&&! "
$num&&" %
,&&% &
new&&' *
{&&+ ,
message&&- 4
=&&5 6
ex&&7 9
.&&9 :
Message&&: A
}&&B C
)&&C D
;&&D E
}'' 
}(( 	
[** 	
	Authorize**	 
]** 
[++ 	
HttpGet++	 
(++ 
$str++ 
)++ 
]++  
public,, 
async,, 
Task,, 
<,, 
IActionResult,, '
>,,' (
ViewBookById,,) 5
(,,5 6
int,,6 9
bookId,,: @
),,@ A
{-- 	
try.. 
{// 
var00 
result00 
=00 
await00 "
_bookBL00# *
.00* +
ViewBookByIdAsync00+ <
(00< =
bookId00= C
)00C D
;00D E
if11 
(11 
result11 
.11 
Success11 "
==11# %
true11& *
)11* +
{22 
return33 
Ok33 
(33 
result33 $
)33$ %
;33% &
}44 
else55 
{66 
return77 

BadRequest77 %
(77% &
result77& ,
)77, -
;77- .
}88 
}99 
catch:: 
(:: 
	Exception:: 
ex:: 
)::  
{;; 
return<< 

StatusCode<< !
(<<! "
$num<<" %
,<<% &
new<<' *
{<<+ ,
message<<- 4
=<<5 6
ex<<7 9
.<<9 :
Message<<: A
}<<B C
)<<C D
;<<D E
}== 
}>> 	
[@@ 	
HttpGet@@	 
(@@ 
$str@@ 
)@@ 
]@@  
publicAA 
asyncAA 
TaskAA 
<AA 
IActionResultAA '
>AA' (
GetAllBooksAA) 4
(AA4 5
)AA5 6
{BB 	
tryCC 
{DD 
varEE 
resultEE 
=EE 
awaitEE "
_bookBLEE# *
.EE* +
GetAllBooksAsyncEE+ ;
(EE; <
)EE< =
;EE= >
ifFF 
(FF 
resultFF 
.FF 
SuccessFF "
==FF# %
trueFF& *
)FF* +
{GG 
returnHH 
OkHH 
(HH 
resultHH $
)HH$ %
;HH% &
}II 
elseJJ 
{KK 
returnLL 

BadRequestLL %
(LL% &
resultLL& ,
)LL, -
;LL- .
}MM 
}NN 
catchOO 
(OO 
	ExceptionOO 
exOO 
)OO  
{PP 
returnQQ 

StatusCodeQQ !
(QQ! "
$numQQ" %
,QQ% &
newQQ' *
{QQ+ ,
messageQQ- 4
=QQ5 6
exQQ7 9
.QQ9 :
MessageQQ: A
}QQB C
)QQC D
;QQD E
}RR 
}SS 	
}VV 
}WW ±I
?D:\BridgeLabz\BookStore\BookStore\Controllers\CartController.cs
	namespace 	
	BookStore
 
. 
Controllers 
{ 
[		 
Route		 

(		
 
$str		 
)		 
]		 
[

 
ApiController

 
]

 
public 

class 
CartController 
:  !
ControllerBase" 0
{ 
private 
readonly 
ICartBL  
cartBL! '
;' (
public 
CartController 
( 
ICartBL %
cartBL& ,
), -
{ 	
this 
. 
cartBL 
= 
cartBL  
;  !
} 	
[ 	
	Authorize	 
] 
[ 	
HttpPost	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (
	AddToCart) 2
(2 3
AddToCartReqDTO3 B
addToCartReqDTOC R
)R S
{ 	
try 
{ 
var 
userId 
= 
Convert $
.$ %
ToInt32% ,
(, -
User- 1
.1 2
Claims2 8
.8 9
FirstOrDefault9 G
(G H
xH I
=>J L
xM N
.N O
TypeO S
==T V
$strW [
)[ \
?\ ]
.] ^
Value^ c
)c d
;d e
var 
result 
= 
await "
cartBL# )
.) *
AddToCartAsync* 8
(8 9
addToCartReqDTO9 H
,H I
userIdJ P
)P Q
;Q R
if 
( 
result 
. 
Success "
)" #
{ 
return 
Ok 
( 
result $
)$ %
;% &
} 
return 

BadRequest !
(! "
result" (
)( )
;) *
}   
catch!! 
(!! 
	Exception!! 
ex!! 
)!!  
{"" 
return## 

BadRequest## !
(##! "
ex##" $
.##$ %
Message##% ,
)##, -
;##- .
}$$ 
}%% 	
['' 	
	Authorize''	 
]'' 
[(( 	

HttpDelete((	 
((( 
$str(( $
)(($ %
]((% &
public)) 
async)) 
Task)) 
<)) 
IActionResult)) '
>))' (
RemoveFromCart))) 7
())7 8
int))8 ;
cartId))< B
)))B C
{** 	
try++ 
{,, 
var-- 
userId-- 
=-- 
Convert-- $
.--$ %
ToInt32--% ,
(--, -
User--- 1
.--1 2
Claims--2 8
.--8 9
FirstOrDefault--9 G
(--G H
x--H I
=>--J L
x--M N
.--N O
Type--O S
==--T V
$str--W [
)--[ \
?--\ ]
.--] ^
Value--^ c
)--c d
;--d e
var--f i
result--j p
=--q r
await--s x
cartBL--y 
.	-- Ä!
RemoveFromCartAsync
--Ä ì
(
--ì î
cartId
--î ö
,
--ö õ
userId
--ú ¢
)
--¢ £
;
--£ §
if.. 
(.. 
result.. 
... 
Success.. "
).." #
{// 
return00 
Ok00 
(00 
result00 $
)00$ %
;00% &
}11 
return22 

BadRequest22 !
(22! "
result22" (
)22( )
;22) *
}33 
catch44 
(44 
	Exception44 
ex44 
)44  
{55 
return66 

BadRequest66 !
(66! "
ex66" $
.66$ %
Message66% ,
)66, -
;66- .
}77 
}88 	
[:: 	
	Authorize::	 
]:: 
[;; 	
HttpGet;;	 
(;; 
$str;; "
);;" #
];;# $
public<< 
async<< 
Task<< 
<<< 
IActionResult<< '
><<' (
GetAllCartItems<<) 8
(<<8 9
)<<9 :
{== 	
try>> 
{?? 
var@@ 
userId@@ 
=@@ 
Convert@@ $
.@@$ %
ToInt32@@% ,
(@@, -
User@@- 1
.@@1 2
Claims@@2 8
.@@8 9
FirstOrDefault@@9 G
(@@G H
x@@H I
=>@@J L
x@@M N
.@@N O
Type@@O S
==@@T V
$str@@W [
)@@[ \
?@@\ ]
.@@] ^
Value@@^ c
)@@c d
;@@d e
varBB 
resultBB 
=BB 
awaitBB "
cartBLBB# )
.BB) * 
GetAllCartItemsAsyncBB* >
(BB> ?
userIdBB? E
)BBE F
;BBF G
ifCC 
(CC 
resultCC 
.CC 
SuccessCC "
)CC" #
{DD 
returnEE 
OkEE 
(EE 
resultEE $
)EE$ %
;EE% &
}FF 
returnGG 

BadRequestGG !
(GG! "
resultGG" (
)GG( )
;GG) *
}HH 
catchII 
(II 
	ExceptionII 
exII 
)II  
{JJ 
returnKK 

BadRequestKK !
(KK! "
exKK" $
.KK$ %
MessageKK% ,
)KK, -
;KK- .
}LL 
}MM 	
[OO 	
	AuthorizeOO	 
]OO 
[PP 	
HttpPutPP	 
(PP 
$strPP 
)PP 
]PP 
publicQQ 
asyncQQ 
TaskQQ 
<QQ 
IActionResultQQ '
>QQ' (

UpdateCartQQ) 3
(QQ3 4
intQQ4 7
cartIdQQ8 >
,QQ> ?
intQQ@ C
quantityQQD L
)QQL M
{RR 	
trySS 
{TT 
varUU 
userIdUU 
=UU 
ConvertUU $
.UU$ %
ToInt32UU% ,
(UU, -
UserUU- 1
.UU1 2
ClaimsUU2 8
.UU8 9
FirstOrDefaultUU9 G
(UUG H
xUUH I
=>UUJ L
xUUM N
.UUN O
TypeUUO S
==UUT V
$strUUW [
)UU[ \
?UU\ ]
.UU] ^
ValueUU^ c
)UUc d
;UUd e
varWW 
resultWW 
=WW 
awaitWW "
cartBLWW# )
.WW) *
UpdateCartAsyncWW* 9
(WW9 :
cartIdWW: @
,WW@ A
quantityWWB J
,WWJ K
userIdWWL R
)WWR S
;WWS T
ifXX 
(XX 
resultXX 
.XX 
SuccessXX "
)XX" #
{YY 
returnZZ 
OkZZ 
(ZZ 
resultZZ $
)ZZ$ %
;ZZ% &
}[[ 
return\\ 

BadRequest\\ !
(\\! "
result\\" (
)\\( )
;\\) *
}]] 
catch^^ 
(^^ 
	Exception^^ 
ex^^ 
)^^  
{__ 
return`` 

BadRequest`` !
(``! "
ex``" $
.``$ %
Message``% ,
)``, -
;``- .
}aa 
}bb 	
[dd 	
	Authorizedd	 
]dd 
[ee 	

HttpDeleteee	 
(ee 
$stree 
)ee  
]ee  !
publicff 
asyncff 
Taskff 
<ff 
IActionResultff '
>ff' (
	ClearCartff) 2
(ff2 3
)ff3 4
{gg 	
tryhh 
{ii 
varjj 
userIdjj 
=jj 
Convertjj $
.jj$ %
ToInt32jj% ,
(jj, -
Userjj- 1
.jj1 2
Claimsjj2 8
.jj8 9
FirstOrDefaultjj9 G
(jjG H
xjjH I
=>jjJ L
xjjM N
.jjN O
TypejjO S
==jjT V
$strjjW [
)jj[ \
?jj\ ]
.jj] ^
Valuejj^ c
)jjc d
;jjd e
varll 
resultll 
=ll 
awaitll "
cartBLll# )
.ll) *
ClearCartAsyncll* 8
(ll8 9
userIdll9 ?
)ll? @
;ll@ A
ifmm 
(mm 
resultmm 
.mm 
Successmm "
)mm" #
{nn 
returnoo 
Okoo 
(oo 
resultoo $
)oo$ %
;oo% &
}pp 
returnqq 

BadRequestqq !
(qq! "
resultqq" (
)qq( )
;qq) *
}rr 
catchss 
(ss 
	Exceptionss 
exss 
)ss  
{tt 
returnuu 

BadRequestuu !
(uu! "
exuu" $
.uu$ %
Messageuu% ,
)uu, -
;uu- .
}vv 
}ww 	
}{{ 
}|| ÌB
BD:\BridgeLabz\BookStore\BookStore\Controllers\AddressController.cs
	namespace 	
	BookStore
 
. 
Controllers 
{ 
[		 
Route		 

(		
 
$str		 
)		 
]		 
[

 
ApiController

 
]

 
public 

class 
AddressController "
:# $
ControllerBase% 3
{ 
private 
readonly 

IAddressBL #

_addressBL$ .
;. /
public 
AddressController  
(  !

IAddressBL! +
	addressBL, 5
)5 6
{ 	

_addressBL 
= 
	addressBL "
;" #
} 	
[ 	
	Authorize	 
] 
[ 	
HttpPost	 
( 
$str 
) 
]  
public 
async 
Task 
< 
IActionResult '
>' (

AddAddress) 3
(3 4
UserAddressReqDTO4 E
requestF M
)M N
{ 	
try 
{ 
var 
userId 
= 
Convert $
.$ %
ToInt32% ,
(, -
User- 1
.1 2
Claims2 8
.8 9
FirstOrDefault9 G
(G H
xH I
=>J L
xM N
.N O
TypeO S
==T V
$strW [
)[ \
?\ ]
.] ^
Value^ c
)c d
;d e
var 
result 
= 
await "

_addressBL# -
.- .
AddAddressAsync. =
(= >
request> E
,E F
userIdG M
)M N
;N O
if 
( 
result 
. 
Success "
==# %
true& *
)* +
{ 
return 
Ok 
( 
result $
)$ %
;% &
} 
else 
{   
return!! 

BadRequest!! %
(!!% &
result!!& ,
)!!, -
;!!- .
}"" 
}## 
catch$$ 
($$ 
	Exception$$ 
ex$$ 
)$$  
{%% 
return&& 

StatusCode&& !
(&&! "
$num&&" %
,&&% &
new&&' *
{&&+ ,
message&&- 4
=&&5 6
ex&&7 9
.&&9 :
Message&&: A
}&&B C
)&&C D
;&&D E
}'' 
}(( 	
[)) 	
	Authorize))	 
])) 
[** 	
HttpPut**	 
(** 
$str**  
)**  !
]**! "
public++ 
async++ 
Task++ 
<++ 
IActionResult++ '
>++' (
UpdateAddress++) 6
(++6 7
UserAddressReqDTO++7 H
request++I P
,++P Q
int++R U
	addressId++V _
)++_ `
{,, 	
try-- 
{.. 
var// 
userId// 
=// 
Convert// $
.//$ %
ToInt32//% ,
(//, -
User//- 1
.//1 2
Claims//2 8
.//8 9
FirstOrDefault//9 G
(//G H
x//H I
=>//J L
x//M N
.//N O
Type//O S
==//T V
$str//W [
)//[ \
?//\ ]
.//] ^
Value//^ c
)//c d
;//d e
var00 
result00 
=00 
await00 "

_addressBL00# -
.00- .
UpdateAddressAsync00. @
(00@ A
request00A H
,00H I
	addressId00J S
,00S T
userId00U [
)00[ \
;00\ ]
if11 
(11 
result11 
.11 
Success11 "
==11# %
true11& *
)11* +
{22 
return33 
Ok33 
(33 
result33 $
)33$ %
;33% &
}44 
else55 
{66 
return77 

BadRequest77 %
(77% &
result77& ,
)77, -
;77- .
}88 
}99 
catch:: 
(:: 
	Exception:: 
ex:: 
)::  
{;; 
return<< 

StatusCode<< !
(<<! "
$num<<" %
,<<% &
new<<' *
{<<+ ,
message<<- 4
=<<5 6
ex<<7 9
.<<9 :
Message<<: A
}<<B C
)<<C D
;<<D E
}== 
}>> 	
[?? 	
	Authorize??	 
]?? 
[@@ 	

HttpDelete@@	 
(@@ 
$str@@ #
)@@# $
]@@$ %
publicAA 
asyncAA 
TaskAA 
<AA 
IActionResultAA '
>AA' (
DeleteAddressAA) 6
(AA6 7
intAA7 :
	addressIdAA; D
)AAD E
{BB 	
tryCC 
{DD 
varEE 
userIdEE 
=EE 
ConvertEE $
.EE$ %
ToInt32EE% ,
(EE, -
UserEE- 1
.EE1 2
ClaimsEE2 8
.EE8 9
FirstOrDefaultEE9 G
(EEG H
xEEH I
=>EEJ L
xEEM N
.EEN O
TypeEEO S
==EET V
$strEEW [
)EE[ \
?EE\ ]
.EE] ^
ValueEE^ c
)EEc d
;EEd e
varFF 
resultFF 
=FF 
awaitFF "

_addressBLFF# -
.FF- .
DeleteAddressAsyncFF. @
(FF@ A
	addressIdFFA J
,FFJ K
userIdFFL R
)FFR S
;FFS T
ifGG 
(GG 
resultGG 
.GG 
SuccessGG "
==GG# %
trueGG& *
)GG* +
{HH 
returnII 
OkII 
(II 
resultII $
)II$ %
;II% &
}JJ 
elseKK 
{LL 
returnMM 

BadRequestMM %
(MM% &
resultMM& ,
)MM, -
;MM- .
}NN 
}OO 
catchPP 
(PP 
	ExceptionPP 
exPP 
)PP  
{QQ 
returnRR 

StatusCodeRR !
(RR! "
$numRR" %
,RR% &
newRR' *
{RR+ ,
messageRR- 4
=RR5 6
exRR7 9
.RR9 :
MessageRR: A
}RRB C
)RRC D
;RRD E
}SS 
}TT 	
[UU 	
	AuthorizeUU	 
]UU 
[VV 	
HttpGetVV	 
(VV 
$strVV "
)VV" #
]VV# $
publicWW 
asyncWW 
TaskWW 
<WW 
IActionResultWW '
>WW' (
GetAllAddressesWW) 8
(WW8 9
)WW9 :
{XX 	
tryYY 
{ZZ 
var[[ 
userId[[ 
=[[ 
Convert[[ $
.[[$ %
ToInt32[[% ,
([[, -
User[[- 1
.[[1 2
Claims[[2 8
.[[8 9
FirstOrDefault[[9 G
([[G H
x[[H I
=>[[J L
x[[M N
.[[N O
Type[[O S
==[[T V
$str[[W [
)[[[ \
?[[\ ]
.[[] ^
Value[[^ c
)[[c d
;[[d e
var\\ 
result\\ 
=\\ 
await\\ "

_addressBL\\# -
.\\- . 
GetAllAddressesAsync\\. B
(\\B C
userId\\C I
)\\I J
;\\J K
if]] 
(]] 
result]] 
.]] 
Success]] "
==]]# %
true]]& *
)]]* +
{^^ 
return__ 
Ok__ 
(__ 
result__ $
)__$ %
;__% &
}`` 
elseaa 
{bb 
returncc 

BadRequestcc %
(cc% &
resultcc& ,
)cc, -
;cc- .
}dd 
}ee 
catchff 
(ff 
	Exceptionff 
exff 
)ff  
{gg 
returnhh 

StatusCodehh !
(hh! "
$numhh" %
,hh% &
newhh' *
{hh+ ,
messagehh- 4
=hh5 6
exhh7 9
.hh9 :
Messagehh: A
}hhB C
)hhC D
;hhD E
}ii 
}jj 	
}kk 
}ll 